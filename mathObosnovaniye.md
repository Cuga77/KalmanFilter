### Математическое обоснование результатов (Анализ погрешности моделей)

Различие в точности оценок (SSE $1.50$ против $1.08$) объясняется структурой фундаментальных матриц решений для выбранных систем дифференциальных уравнений.

#### 4.1. Сравнение систем дифференциальных уравнений

Вектор состояния системы: $\mathbf{x}(t) = \begin{pmatrix} \phi(t) \\ \dot{\phi}(t) \end{pmatrix}$.

1.  **Модель 1 (Перманентное вращение):**
    Рассматривает уравнение $\ddot{\phi} = 0$. В матричном виде:
    $$ \dot{\mathbf{x}} = A_1 \mathbf{x}, \quad \text{где} \quad A_1 = \begin{pmatrix} 0 & 1 \\ 0 & 0 \end{pmatrix} $$
    Матрица $A_1$ является нильпотентной ($A_1^2 = \mathbf{0}$).

2.  **Модель 2 (Гармонический осциллятор):**
    Рассматривает уравнение $\ddot{\phi} + \Omega^2\phi = 0$. В матричном виде:
    $$ \dot{\mathbf{x}} = A_2 \mathbf{x}, \quad \text{где} \quad A_2 = \begin{pmatrix} 0 & 1 \\ -\Omega^2 & 0 \end{pmatrix} $$

#### 4.2. Анализ через матричную экспоненту

Дискретный шаг фильтра Калмана (Prediction Step) основан на вычислении матричной экспоненты (фундаментальной матрицы решений) $\Phi(\Delta t) = e^{A \Delta t}$.

**Для Модели 1:**
Так как $A_1^2 = 0$, ряд Тейлора для экспоненты обрывается на втором слагаемом:
$$ \Phi_1(\Delta t) = e^{A_1 \Delta t} = I + A_1 \Delta t = \begin{pmatrix} 1 & \Delta t \\ 0 & 1 \end{pmatrix} $$
Это соответствует **линейной аппроксимации** траектории.

**Для Модели 2:**
Матрица $A_2$ имеет чисто мнимые собственные числа $\lambda = \pm i\Omega$. Разложение в ряд дает:
$$ \Phi_2(\Delta t) = e^{A_2 \Delta t} = \sum_{k=0}^{\infty} \frac{(A_2 \Delta t)^k}{k!} = \begin{pmatrix} \cos(\Omega \Delta t) & \frac{1}{\Omega}\sin(\Omega \Delta t) \\ -\Omega \sin(\Omega \Delta t) & \cos(\Omega \Delta t) \end{pmatrix} $$
Это **точное решение** задачи Коши для осциллятора.

#### 4.3. Оценка локальной ошибки аппроксимации

Разложим точное решение (Модель 2) в ряд Тейлора по малому параметру $\Delta t$ и сравним с Моделью 1.

$$ \mathbf{x}_{true}(t + \Delta t) = \mathbf{x}(t) + \dot{\mathbf{x}}(t)\Delta t + \frac{1}{2}\ddot{\mathbf{x}}(t)\Delta t^2 + O(\Delta t^3) $$

Подставим $\ddot{\mathbf{x}} = A_2 \dot{\mathbf{x}} = A_2 (A_2 \mathbf{x}) = -\Omega^2 \begin{pmatrix} \phi \\ \dot{\phi} \end{pmatrix} = -\Omega^2 \mathbf{x}$ (для упрощения структуры):

Для первой компоненты (угла $\phi$):
$$ \phi_{true}(t+\Delta t) = \phi(t) + \dot{\phi}(t)\Delta t \underbrace{- \frac{1}{2}\Omega^2 \phi(t) \Delta t^2}_{\text{Член второго порядка}} + \dots $$

Прогноз Модели 1:
$$ \phi_{model1}(t+\Delta t) = \phi(t) + \dot{\phi}(t)\Delta t $$

**Вывод:** Модель 1 имеет **методическую погрешность порядка $O(\Delta t^2)$**, пропорциональную квадрату частоты колебаний $\Omega^2$ и текущей амплитуде $\phi(t)$.
Именно поэтому на графике ошибки Модели 1 максимальны в точках экстремума (где $|\phi|$ максимально), и минимальны при прохождении положения равновесия (где $\phi \approx 0$, и системы локально совпадают).

#### 4.4. Фазовый портрет и устойчивость

С точки зрения теории устойчивости:
*   **Модель 1:** Фазовые траектории — прямые линии ($\dot{\phi} = const$). Система неустойчива по Ляпунову (любое возмущение скорости приводит к бесконечному уходу координаты).
*   **Модель 2:** Фазовые траектории — эллипсы (замкнутые орбиты). Система устойчива по Ляпунову.

Использование Модели 1 для описания периодического процесса является попыткой аппроксимировать окружность (фазовую траекторию маятника) касательными прямыми. Фильтр Калмана вынужден на каждом шаге "ломать" прямую линию, подгоняя её под измерения, что и порождает наблюдаемую ошибку (SSE = 1.50). Модель 2 движется точно по эллипсу, требуя коррекции только для компенсации случайного шума измерений, что дает минимальную ошибку (SSE = 1.08).